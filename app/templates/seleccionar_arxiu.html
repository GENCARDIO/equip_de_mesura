{% extends "base.html" %}

{% block content %}

<head>
  <style>
    /* Estilos para el popup */
    .popup {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      text-align: center;
    }

    .popup-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #fff;
      padding: 20px;
      box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);
    }

    /* Estilo para el botón de cerrar */
    .popup-close {
      cursor: pointer;
      position: absolute;
      top: 10px;
      right: 10px;
      color: red;
      /* Cambiamos el color a rojo */
      font-size: 30px;
      margin-right: 10px;
    }

    /* Estilo para el campo de búsqueda */
    .image-search {
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
    }

    /* Estilos para la imagen cargada */
    #uploadedImage {
      max-width: 100%;
      max-height: 300px;
      /* Limitamos la altura para que quepa en el popup */
      margin-top: 10px;
      /* Añadimos un espacio entre el campo de búsqueda y la imagen */
    }

    /* Estilo para el mensaje "Imagen cargada" */
    #imageUploadedText {
      display: none;
      color: green;
      /* Cambiamos el color a verde */
      margin-top: 10px;
      /* Añadimos un espacio entre la imagen y el mensaje */
    }
  </style>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>

<body>
  <!-- Flash -->
  <div class="d-flex justify-content-center">
    <div class="row mt-1">
      {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
      {% for category,message in messages %}
      <div class="alert alert-{{ category }} alert-dismissible fade show ml-3" role="alert">
        <span>{{ message }}</span>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <br>
      </div>
      {% endfor %}
      {% endif %}
      {% endwith %}
    </div>
  </div>

  <!-- <form></form> -->
  <div class="flex" style="width:90%;margin:0 auto; margin-bottom: 20px;">

    <div class="row">

      <!-- Titol -->
      <div class="col-12">
        <h1 class="card-title" style="margin-top:30px;color:rgb(252, 198, 100); text-align: center;">
          <div style="display:inline-block;"><b>FITXA TÈCNICA EQUIP DE MESURA</b></div>
          <div style="display:inline-block; color:#636261">CODI {{dades.codi_aux}}</div>
        </h1>
      </div>

      <hr>

      <!-- Descripció -->
      <div class="col-12">
        <div class="card card-body border-1 m-1" style="background-color:#EDEDED; text-align: center;">
          <div class="col-12">
            <p style="margin-bottom: 5px; font-weight: bold;">Descripció</p>
            <input type="text" style="width: 400px;" value="{{dades.descripcio}}">
          </div>
        </div>
      </div>

      <br>

      <!-- Caracteristiques generals -->
      <div class="col-12">
        <div class="card card-body border-1 m-1" style="background-color:#EDEDED; text-align: center;">
          <div class="col-12">
            <p style="margin-bottom: 10px; font-weight: bold;">Caracteristiques generals</p>
            <table class="table table-bordered">
              <thead style="text-align: center; font-size: 12;">
                <tr style="background-color: rgb(174, 204, 231);">
                  <th>FABRICANT</th>
                  <th>REFERÈNCIA FABRICANT</th>
                  <th>SERIAL NUMBER</th>
                  <th>MODEL</th>
                  <th>PROVEÏDOR</th>
                  <th>Servei Tècnic</th>
                  <th>Telèfon</th>
                  <th style="width: 22%;"><i class="fa-solid fa-image"></i></th>
                </tr>
              </thead>
              <tbody style="font-size: 12;">
                <tr>
                  <td><input type="text" value="{{dades.fabricant}}"></td>
                  <td><input type="text" value="{{dades.ref_fabricant}}"></td>
                  <td><input type="text" value="{{dades.serial_number}}"></td>
                  <td><input type="text" value="{{dades.model}}"></td>
                  <td><input type="text" value="{{dades.emp_subministradora}}"></td>
                  <td><input type="text" value="XXXXXXXXX"></td>
                  <td><input type="text" value="666666666"></td>
                  <td> <input type="file" id="imagenInput" accept="image/*">
                    <img width="300px" height="200px" style="margin-top: 15px; margin-left: 25px;" id="imagenMostrada"
                      src="">
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Informació compra -->
      <div class="col-12">
        <div class="card card-body border-1 m-1" style="background-color:#EDEDED; text-align: center;">
          <div class="col-12">
            <p style="margin-bottom: 10px; font-weight: bold;">Informació compra</p>
            <table class="table table-bordered">
              <thead style="text-align: center; font-size: 12;">
                <tr style="background-color: rgb(174, 204, 231);">
                  <th>DATA ALTA</th>
                  <th>Condicions</th>
                  <th>Data Baixa</th>
                  <th>SITUACIÓ CONTRACTUAL</th>
                  <th>PREU</th>
                  <th>TIPUS D'EQUIP</th>
                  <th style="width: 22%;"><i class="fa-solid fa-image"></i></th>
                </tr>
              </thead>
              <tbody style="font-size: 12;">
                <tr>
                  <td><input type="text" value="{{dades.data_alta}}"></td>
                  <td><input type="text" value="{{dades.condicions_equip}}"></td>
                  <td><input type="text" value="{{dades.data_baixa}}"></td>
                  <td><input type="text" value="{{dades.situacio_contractual}}"></td>
                  <td><input type="text" value="{{dades.preu}}"></td>
                  <td><input type="text" value="{{dades.tipus}}"></td>
                  <td> <input type="file" id="imagenInput2" accept="image/*">
                    <img width="300px" height="200px" style="margin-top: 15px; margin-left: 25px;" id="imagenMostrada2"
                      src="">
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Caracteristiques fisiques -->
      <div class="col-12">
        <div class="card card-body border-1 m-1" style="background-color:#EDEDED; text-align: center;">
          <div class="col-12">
            <p style="margin-bottom: 10px; font-weight: bold;">Característiques físiques</p>
            <table class="table table-bordered">
              <thead style="text-align: center; font-size: 12;">
                <tr style="background-color: rgb(174, 204, 231);">
                  <th>Amplada (cm)</th>
                  <th>Alçada (cm)</th>
                  <th>Profunditat (cm)</th>
                  <th>Pes (Kg)</th>
                  <th>Volum (L)</th>
                  <th>Condicions ambientals</th>
                  <th>Humitat</th>
                  <th>Presa d'aigua desionitzada</th>
                  <th style="width: 22%;"><i class="fa-solid fa-image"></i></th>
                </tr>
              </thead>
              <tbody style="font-size: 12;">
                <tr>
                  <td><input type="text" value="{{dades.amplada}}"></td>
                  <td><input type="text" value="{{dades.alçada}}"></td>
                  <td><input type="text" value="{{dades.profunditat}}"></td>
                  <td><input type="text" style="width: 60px;" value="{{dades.pes}}"></td>
                  <td><input type="text" style="width: 60px;" value="None"></td>
                  <td><input type="text" value="{{dades.condicions_ambientals}}"></td>
                  <td><input type="text" value="{{dades.humitat}}"></td>
                  <td><input type="text" value="{{dades.presa_aigua}}"></td>
                  <td> <input type="file" id="imagenInput3" accept="image/*">
                    <img width="300px" height="200px" style="margin-top: 15px; margin-left: 25px;" id="imagenMostrada3"
                      src="">
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Connexions periferics -->
      <div class="col-12">
        <div class="card card-body border-1 m-1" style="background-color:#EDEDED; text-align: center;">
          <div class="col-12">
            <p style="margin-bottom: 10px; font-weight: bold;">Connexions periferics</p>

            <table class="table table-bordered">
              <thead style="text-align: center; font-size: 12;">

                <tr>
                  <th>SI/NO</th>
                  <th>MARCA</th>
                  <th>MODEL</th>
                  <th>Número de serie</th>
                  <th>Código de inventario</th>
                </tr>
                <tr>
                  <td>Pantalla</td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                </tr>
                <tr>
                  <td>SAI</td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                </tr>
                <tr>
                  <td>Lector código de barras</td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                </tr>
                <tr>
                  <td>Impresora</td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                </tr>
                <tr>
                  <td>Tensión: 220V/50Hz <br> Potencia: 220W</td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                  <td><input type="text" value=""></td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                </tr>
                <tr>
                  <td>Software</td>
                  <td><input type="text" value=""></td>
                  <td>Versió</td>
                  <td colspan="2"><input type="text" value=""></td>
                  <td></td>
                </tr>
                <tr>
                  <td>Software</td>
                  <td><input type="text" value=""></td>
                  <td>Versió</td>
                  <td colspan="2"><input type="text" value=""></td>
                  <td></td>
                </tr>
                <tr>
                  <td>Software</td>
                  <td><input type="text" value=""></td>
                  <td>Versió</td>
                  <td colspan="2"><input type="text" value=""></td>
                  <td></td>
                </tr>
              </thead>
            </table>
          </div>
        </div>
      </div>

      <!-- Personal responsable -->
      <div class="col-12">
        <div class="card card-body border-1 m-1" style="background-color:#EDEDED; text-align: center;">
          <div class="col-12">
            <p style="margin-bottom: 10px; font-weight: bold;">Personal responsable</p>
            <table class="table table-bordered">
              <thead style="text-align: center; font-size: 12;">
                <tr>
                  <th style="width: 50%;">PERSONAL TECNIC</th>
                  <th style="width: 50%;">PERSONAL FACULTATIU</th>
                </tr>
              </thead>
              <tbody style="font-size: 12; text-align: center;">
                <tr>
                  <td>PERSONAL TECNIC UDMMP</td>
                  <td>Facultatius responsables de l'àrea UDMMP</td>
                </tr>
                <tr>
                  <td><input type="text" style="width: 300px;" value=""></td>
                  <td><input type="text" style="width: 300px;" value=""></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Fungible -->
      <div class="col-12">
        <div class="card card-body border-1 m-1" style="background-color:#EDEDED; text-align: center;">
          <div class="col-12">
            <p style="margin-bottom: 10px; font-weight: bold;">Fungible</p>
            <table class="table table-bordered">
              <thead style="text-align: center; font-size: 12;">
                <tr>
                  <th style="width: 50%;">Referencia</th>
                  <th style="width: 50%;">Descripcio</th>
                </tr>
              </thead>
              <tbody style="font-size: 12; text-align: center;">
                <tr>
                  <td><input type="text" style="width: 300px;" value=""></td>
                  <td><input type="text" style="width: 300px;" value=""></td>
                </tr>
                <tr>
                  <td><input type="text" style="width: 300px;" value=""></td>
                  <td><input type="text" style="width: 300px;" value=""></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Pla de manteniment -->
      <div class="col-12">
        <div class="card card-body border-1 m-1" style="background-color:#EDEDED; text-align: center;">
          <div class="col-12">
            <p style="margin-bottom: 10px; font-weight: bold;">Pla de manteniment</p>

            <table class="table table-bordered">
              <thead style="text-align: center; font-size: 12;">
                <tr>
                  <th style="width: 100%; background-color: rgb(174, 204, 231);">DOCUMENTS ASSAIGS D’ACCEPTACIÓ</th>
                </tr>
              </thead>
              <tbody style="font-size: 12; text-align: center;">
                <tr>
                  <td><input type="text" style="width: 300px;" value=""></td>
                </tr>
                <tr>
                  <td><input type="text" style="width: 300px;" value=""></td>
                </tr>
              </tbody>
            </table>

            <br>

            <table class="table table-bordered" style="width: 40%; margin: 0 auto;">
              <thead style="text-align: center; font-size: 12;">
                <tr>
                  <th style="width: 80%;"></th>
                  <th style="width: 20%;">SI / NO</th>
                </tr>
              </thead>
              <tbody style="font-size: 12;">
                <tr>
                  <td>Contracte de Manteniment</td>
                  <td><input type="text" style="font-weight: bold;" value=""></td>
                </tr>
                <tr>
                  <td>Manteniment Preventiu Extern</td>
                  <td><input type="text" style="font-weight: bold;" value=""></td>
                </tr>
                <tr>
                  <td>Manteniment preventiu Intern</td>
                  <td><input type="text" style="font-weight: bold;" value=""></td>
                </tr>
                <tr>
                  <td>Verificació Interna</td>
                  <td><input type="text" style="font-weight: bold;" value=""></td>
                </tr>
                <tr>
                  <td>Verificació Externa</td>
                  <td><input type="text" style="font-weight: bold;" value=""></td>
                </tr>
                <tr>
                  <td>Calibració Externa</td>
                  <td><input type="text" style="font-weight: bold;" value=""></td>
                </tr>
                <tr>
                  <td>Calibració interna</td>
                  <td><input type="text" style="font-weight: bold;" value=""></td>
                </tr>
              </tbody>
            </table>

            <br>

            <p style="margin-bottom: 10px; font-weight: bold; text-align: left; font-size: 15px;">DESCRIPCIÓ CONTRACTE
              DE MANTENIMENT:
            </p>

            <p style="margin-bottom: 10px; text-align: left; font-size: 15px;">Nom del contracte:
              <input type="text" style="width: 400px;" value="">
            </p>

            <table class="table table-bordered">
              <thead style="text-align: center; font-size: 12;">
                <tr>
                  <th>Empresa responsable</th>
                  <th>Període de cobertura </th>
                  <th>Dades de contacte (Mail/telèfon)</th>
                </tr>
              </thead>
              <tbody style="font-size: 12; text-align: center;">
                <tr>
                  <td><input type="text" style="width: 300px;" value=""></td>
                  <td><input type="text" style="width: 300px;" value=""></td>
                  <td><input type="text" style="width: 300px;" value=""></td>
                </tr>
                <tr>
                  <td><input type="text" style="width: 300px;" value=""></td>
                  <td><input type="text" style="width: 300px;" value=""></td>
                  <td><input type="text" style="width: 300px;" value=""></td>
                </tr>
              </tbody>
            </table>

            <br>

            <p style="margin-bottom: 10px; font-weight: bold; text-align: left; font-size: 15px;">DESCRIPCIÓ MANTENIMENT
              PREVENTIU EXTERN:
            </p>

            <table class="table table-bordered">
              <thead style="text-align: center; font-size: 12;">
                <tr>
                  <th>Empresa responsable</th>
                  <th>Períodicitat</th>
                  <th>Dades de contacte (Mail/telèfon)</th>
                </tr>
              </thead>
              <tbody style="font-size: 12; text-align: center;">
                <tr>
                  <td><input type="text" style="width: 300px;" value="Lifetechnologies"></td>
                  <td><input type="text" style="width: 300px;" value="Cada 3 anys"></td>
                  <td><input type="text" style="width: 300px;" value="life@technologies / 654654654"></td>
                </tr>
                <tr>
              </tbody>
            </table>

            <table class="table table-bordered" style="width: 40%;">
              <thead style="text-align: center; font-size: 12;">
                <tr>
                  <th>Mateniment</th>
                  <th><input type="text" style="text-align: center; font-weight: bold;" value=""></th>
                </tr>
                <tr>
                  <th>Verificació</th>
                  <th><input type="text" style="text-align: center; font-weight: bold;" value=""></th>
                </tr>
                <tr>
                  <th>Calibratge</th>
                  <th><input type="text" style="text-align: center; font-weight: bold;" value="X"></th>
                </tr>
              </thead>
            </table>

            <p style="margin-bottom: 10px; font-weight: bold; text-align: left; font-size: 15px;">DESCRIPCIÓ:
            </p>

            <p style="margin-bottom: 10px; text-align: left; font-size: 15px;">Marges d’acceptació:
              <input type="text" style="width: 300px;" value="">
            </p>

            <br>

            <p style="margin-bottom: 10px; font-weight: bold; text-align: left; font-size: 15px;">DESCRIPCIÓ MANTENIMENT
              PREVENTIU INTERN:
            </p>

            <p style="margin-bottom: 10px; text-align: left; font-size: 15px; width: 300px;">Descripció:
              <input type="text" value="">
            </p>

            <p style="margin-bottom: 10px; text-align: left; font-size: 15px; width: 300px;">Periodicitat:
              <input type="text" value="">
            </p>

            <p style="margin-bottom: 10px; text-align: left; font-size: 15px;">Marges d'acceptació:
              <input type="text" value="">
            </p>

            <br>

            <p style="margin-bottom: 10px; font-weight: bold; text-align: left; font-size: 15px;">DESCRIPCIÓ Verificació
              Interna:
            </p>

            <p style="margin-bottom: 10px; text-align: left; font-size: 15px; width: 300px;">Descripció:
              <input type="text" value="">
            </p>

            <p style="margin-bottom: 10px; text-align: left; font-size: 15px; width: 300px;">Periodicitat:
              <input type="text" value="">
            </p>

            <p style="margin-bottom: 10px; text-align: left; font-size: 15px;">Marges d'acceptació:
              <input type="text" value="">
            </p>

            <br>

            <p style="margin-bottom: 10px; font-weight: bold; text-align: left; font-size: 15px;">DESCRIPCIÓ Calibratge
              intern:
            </p>

            <p style="margin-bottom: 10px; text-align: left; font-size: 15px; width: 300px;">Descripció:
              <input type="text" value="">
            </p>

            <p style="margin-bottom: 10px; text-align: left; font-size: 15px; width: 300px;">Periodicitat:
              <input type="text" value="">
            </p>

            <p style="margin-bottom: 10px; text-align: left; font-size: 15px;">Marges d'acceptació:
              <input type="text" value="">
            </p>

          </div>
        </div>
      </div>

    </div>
  </div>

  <script>

    const input = document.getElementById('imagenInput');
    const imagenMostrada = document.getElementById('imagenMostrada');

    const input2 = document.getElementById('imagenInput2');
    const imagenMostrada2 = document.getElementById('imagenMostrada2');

    const input3 = document.getElementById('imagenInput3');
    const imagenMostrada3 = document.getElementById('imagenMostrada3');

    // Función para mostrar la imagen
    function mostrarImagen(input, imagenMostrada) {
      const file = input.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function () {
          const imageData = reader.result;
          // Mostrar la imagen en la tabla
          imagenMostrada.src = imageData;
        };
        reader.readAsDataURL(file);
      } else {
        // Borrar la imagen si no se selecciona ninguna
        imagenMostrada.src = '';
      }
    }

    // Asignar evento onchange a cada campo de entrada de archivo
    input.addEventListener('change', () => mostrarImagen(input, imagenMostrada));
    input2.addEventListener('change', () => mostrarImagen(input2, imagenMostrada2));
    input3.addEventListener('change', () => mostrarImagen(input3, imagenMostrada3));

    // Cargar imagen almacenada (si existe) al cargar la página
    window.addEventListener('load', () => mostrarImagen(input, imagenMostrada));
    window.addEventListener('load', () => mostrarImagen(input2, imagenMostrada2));
    window.addEventListener('load', () => mostrarImagen(input3, imagenMostrada3));

  </script>

</body>
{% endblock content %}